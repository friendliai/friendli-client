# pf deployment create

## Usage

```bash
pf deployment create [OPTIONS]
```

## Summary

Creates a deployment object by using model checkpoint.

The deployment settings are described in a configuration YAML file, and the path of that file is
passed to the `-f` option. The following is an example YAML file:

```yaml
orca_config:
    max_batch_size: 384
    max_token_count: 12288
```

:::tip
To turn off the deployment autoscaling, set `--min-replicas` and
`--max-replicas` to the same value.
:::

:::tip
Use `pf vm list` to find available vm-type, cloud, region, and gpu-type.
:::

The default request-response configuration, such as stop tokens or bad words, is
defined in a YAML file. The path of that file is passed to the `-drc` option.
The format of the file is as follows.

```json
{
    "stop": Optional[List[str]],
    "stop_tokens": Optional[List[TokenSequence]],
    "bad_words": Optional[List[str]],
    "bad_word_tokens": Optional[List[TokenSequence]]
}
```

:::caution
Both `bad_words` and `bad_word_tokens` cannot be set at the same time. Also, both
`stop` and `stop_tokens` cannot be set at the same time.

And a TokenSequence type is a dict with the key 'tokens' and the value type List[int].
```json
# Wrong Example: Both `bad_words` and `bad_word_tokens` are set.
{
    "bad_words": ["bad", "words", " bad", " words"]
    "bad_word_tokens": [{"tokens": [568, 36]}, {"tokens": [423, 76]}]
}

# Correct Example
{
    "bad_words": ["bad", "words", " bad", " words"]
    "stop_tokens": [{"tokens": [568, 36]}, {"tokens": [423, 76]}]
}
:::

## Options

| Option | Type | Summary | Default | Required |
|--------|------|---------|---------|----------|
| **`--checkpoint-id`**, **`-i`** | UUID | Checkpoint id to deploy. | - | ✅ |
| **`--name`**, **`-n`** | TEXT | The name of deployment.  | - | ✅ |
| **`--cloud`**, **`-c`** | CHOICE: [aws, azure, gcp] | Type of cloud. | - | ✅ |
| **`--region`**, **`-r`** | TEXT | Region of cloud. | - | ✅ |
| **`--vm-type`**, **`-v`** | CHOICE: [g5.xlarge, a2-highgpu-1g, a2-ultragpu-1g, a2-ultragpu-2g, a2-ultragpu-4g, a2-ultragpu-8g] | The VM type for the deployment. | - | ✅ |
| `--config-file`, `-f` | FILENAME | Path to configuration file. | None | ❌ |
| `--type`, `-t` | CHOICE: [dev, prod] | Type of deployment. | DeploymentType.PROD | ❌ |
| `--description`, `-d` | TEXT | Deployment description. | None | ❌ |
| `--security-level`, `-sl` | CHOICE: [public, protected] | Security level of deployment endpoints | public | ❌ |
| `--logging`, `-l` | BOOLEAN | Logging inference requests or not. | False | ❌ |
| `--default-request-config-file`, `-drc` | FILENAME | Path to default request config | None | ❌ |
| `--min-replicas`, `-min` | INTEGER | Number of minimum replicas. | 1 | ❌ |
| `--max-replicas`, `-max` | INTEGER | Number of maximum replicas. | 1 | ❌ |
